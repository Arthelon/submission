extends ./layout

block head
    link(rel='stylesheet' href='/stylesheets/room.css')

block content
    if submissions
        .header.btns
            .float-left
                a(href='/dashboard') Main
            .float-right
                a(href='/logout') Logout
    .container
        .row.text-center
            h1 #{room_name}
            p #{room_desc}
    .container
        if submissions
            .row
                .col-md-3
                    ul.nav.nav-pills.nav-stacked
                        li.active
                            a(href='#') Submissions
                        li.dropdown
                            a.dropdown-toggle(data-toggle='dropdown', href='#', aria-expanded='false')
                                | Problems
                                span.caret
                            ul.dropdown-menu
                                if problems
                                    each problem in problems
                                        li
                                            a(href='/problem/#{room_name}/#{problem.name}') #{problem.name}
                                else
                                    li
                                        a No Problems Found!
                                li.divider
                                li
                                    a#createProb(href='/problem/#{room_name}') Create Problem
                #subContent
                    .col-md-9#subContent
                        if submissions.length > 0
                            table.table.table-striped.table-hover
                                thead
                                    tr
                                        th Submission Title
                                        th Submitted by
                                        th Description
                                        th Timestamp
                                        th Files
                                tbody
                                    each submission in submissions
                                        tr
                                            td
                                                a#downloadFile(href='/room/#{room_name}/#{submission.name}') #{submission.name}
                                            td #{submission.user}
                                            td #{submission.desc}
                                            td #{submission.timestamp}
                                            td #{submission.files.length}
                                                i.fa.fa-times.cross
                        else
                            .text-center
                                .alert.alert-dismissible.alert-warning
                                    button.fa.fa-close.close(type='button', data-dismiss='alert')
                                    p No submissions found
                #probContent
                    .col-md-9
                        if problems && problems.length > 0
                            table.table.table-striped.table-hover
                                thead
                                    tr
                                        th Problem Name
                                        th Problem Description
                                        th Number of Submissions
                                tbody
                                    each problem in problems
                                        tr
                                            td
                                                a(href='/problem/#{room_name}/#{problem.name}') #{problem.name}
                                            td #{problem.desc}
                                            td #{problem.submissions.length}
                                                i.fa.fa-times.cross
                        else
                            .text-center
                                .alert.alert-dismissible.alert-warning
                                    button.fa.fa-close.close(type='button', data-dismiss='alert')
                                    p No problems found
                    .row
                        .col-md-9.col-md-offset-3
                            .btns.text-center
                                a(href='/problem/#{room_name}') Create Problem
        else
            .panel.panel-default
                .panel-body
                    form#uploadForm(room=room_name action='/room/'+room_name method='POST' encType='multipart/form-data')
                        .form-group.row
                            label.col-lg-2.col-lg-offset-4.control-label(for='nameInput') Submission Title
                            .col-lg-4
                                input.form-control#nameInput(type='text' name='name' placeholder='Title')
                        .form-group.row
                            label.col-lg-2.col-lg-offset-4.control-label(for='userInput') Name
                            .col-lg-4
                                input.form-control#userInput(type='text' name='user' placeholder='Enter your name')
                        .form-group.row
                            label.col-lg-2.col-lg-offset-4.control-label(for='descInput') Description
                            .col-lg-4
                                input.form-control#descInput(type='text' name='desc' placeholder='Optional')
                        .form-group.row
                            label.col-lg-2.col-lg-offset-4.control-label(for='select') Problem
                            .col-lg-4
                                select#select.form-control(name='prob')
                                    option None
                                    each prob in problems
                                        option #{prob.name}
                        .fileInput.form-group
                            input(type='file' name='file' id='file' data-multiple-caption="{count} files selected" multiple)
                            label(for="file")
                                i.fa.fa-upload
                                span Choose a file...
                        #editor
                        button.btn.btn-default(type='submit') Upload
        .errors.text-center
            if messages.error
                each error in messages.error
                    p #{error}
block script
    script(type='text/javascript').
        var room_name = '#{room_name}'
    if !submissions
        script(type='text/javascript' src='https://cdn.jsdelivr.net/ace/1.2.3/min/ace.js')
    script(type='text/javascript' src='/javascripts/room_client.js')
