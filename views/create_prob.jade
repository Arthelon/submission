extends ./layout

block content
    .header
        .btns
            .float-left
                a(href='/') Home
            .float-right
                a(href='/logout') Logout
    .container
        h3 Create Problem
        hr
        .row
            .col-md-6
                .panel.panel-default
                    .panel-heading.clearfix
                        h3.panel-title Create Problem
                    .panel-body
                        form
                            .form-group
                                label.col-lg-4.control-label(for='probName') Problem
                                input#probName.form-control(name='name' type='text', placeholder='Name')
                            .form-group
                                label.col-lg-4.control-label(for='probDesc') Problem Description
                                input#probDesc.form-control(name='desc' type='text', placeholder='Description')
                            if errors
                                p #{errors}
                            button.btn.btn-success(type='submit') Submit
        .row.msg.text-center

block script
    script(type='text/javascript').
        $(function () {
            var $msg = $('.msg')
            $("form").submit(function (e) {
                e.preventDefault()
                $msg.empty()
                $.ajax({
                    method: "POST",
                    url: "/problem/#{room_name}",
                    data: $(this).serialize(),
                    dataType: 'json'
                }).then(function (data) {
                    if (!data.success) data.success = 'Success'
                    $msg.append('<p style="color:green;">' + data.success + '</p>')
                }, function (data) {
                    if (!data.responseJSON.error) data.responseJSON.error = 'Error'
                    $msg.append('<p style="color:red;">' + data.responseJSON.error + '</p>')
                })
                $(this).trigger('reset')
            })
        })